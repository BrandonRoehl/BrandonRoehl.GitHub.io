---
---
<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">

<dom-module id="my-blog">

  <template>

    <style>
      :host {
        display: block;
        padding: 10px;
      }
    </style>

    <div class="card">
        <ul>
            {% for post in site.posts %}
            <li>
                <a href="#/blog/{{post.url|remove:'/blog/'|remove:'.html'}}">{{ post.title }}</a>
            </li>
            {% endfor %}
        </ul>
    </div>

    {% raw  %}
    <app-route
        route="{{route}}"
        pattern="/:post"
        data="{{routeData}}"></app-route>
    {% endraw %}
    <iron-pages selected="[[post]]" attr-for-selected="name">
        {% for post in site.posts %}
            <{{post.url|remove:'/blog/'|remove:'.html'}} name="{{post.url|remove:'/blog/'|remove:'.html'}}"></{{post.url|remove:'/blog/'|remove:'.html'}}>
        {% endfor %}
    </iron-pages>

  </template>

  <script>

    Polymer({
        is: 'my-blog',

        properties: {

            post: {
                type: String,
                reflectToAttribute: true,
                observer: '_pageChanged'
            },
        },

        observers: [
            '_routePageChanged(routeData.post)'
        ],

        _routePageChanged: function(post) {
            this.post = post || "{{site.posts.first.url|remove:'/blog/'|remove:'.html'}}";
        },

        _pageChanged: function(post) {
            // load page import on demand.
            this.importHref(this.resolveUrl('../blog/' + post + '.html'), null, null, true);
        }

    });

  </script>

</dom-module>

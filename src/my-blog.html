---
---
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../stylesheets/shared-styles.html">

<dom-module id="my-blog">

    <template>

        <style include="shared-styles"></style>
        <style is="custom-style">
            :host {
                display: block;
                padding-top: 1em;
            }
            .container {
                width: 100%;
                max-width: 60rem;
                display: block;
                margin: 0 auto;
            }
            .container paper-card {
                width: 100%;
                padding: 0.5em;
            }
        </style>

    {% raw  %}
    <app-route
        route="{{route}}"
        pattern="/:post"
        data="{{routeData}}"></app-route>
    {% endraw %}

    <div class="container">
        <paper-tabs selected="[[post]]" scrollable attr-for-selected="name">
            {% for post in site.posts %}
            {% assign name = post.url|remove:'/blog/'|remove:'.html' %}
            <paper-tab link name="{{name}}">
                <a href="/#/blog/{{name}}" tabindex="-1">{{ post.title }}</a>
            </paper-tab>
            {% endfor %}
        </paper-tabs>

        <paper-card>
            <iron-pages selected="[[post]]" attr-for-selected="name">
                {% for post in site.posts %}
                {% assign name = post.url|remove:'/blog/'|remove:'.html' %}
                <{{name}} name="{{name}}"></{{name}}>
                {% endfor %}
            </iron-pages>
        </paper-card>
    </div>

  </template>

  <script>

    Polymer({
        is: 'my-blog',

        properties: {

            post: {
                type: String,
                reflectToAttribute: true,
                observer: '_pageChanged'
            },
        },

        observers: [
            '_routePageChanged(routeData.post)'
        ],

        _routePageChanged: function(post) {
            this.post = post || "{{site.posts.first.url|remove:'/blog/'|remove:'.html'}}";
        },

        _pageChanged: function(post) {
            // load page import on demand.
            this.importHref(this.resolveUrl('../blog/' + post + '.html'), null, null, true);
        }

    });

  </script>

</dom-module>

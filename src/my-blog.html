---
---
<!--
@license
Copyright (c) 2016 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/iron-pages/iron-pages.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-styles/color.html">

<dom-module id="my-blog">

  <template>

    <style is="custom-style">
        :host {
            display: block;
            padding: 10px;
        }
        paper-tab[link] a {
            /* These mixins (from iron-flex-layout) center the link text. */
            @apply --layout-horizontal;
            @apply --layout-center-center;
            color: #212121;
            padding: 1em;
            text-decoration: none;
        }
        :root {
            --paper-tab-ink: var(--paper-blue-700);
            --paper-tabs-selection-bar-color: var(--paper-blue-700);
        }
    </style>

    {% raw  %}
    <app-route
        route="{{route}}"
        pattern="/:post"
        data="{{routeData}}"></app-route>
    {% endraw %}

    <paper-tabs selected="[[post]]" scrollable attr-for-selected="name">
        {% for post in site.posts %}
        <paper-tab link name="{{post.url|remove:'/blog/'|remove:'.html'}}">
            <a href="#/blog/{{post.url|remove:'/blog/'|remove:'.html'}}" tabindex="-1">{{ post.title }}</a>
        </paper-tab>
        {% endfor %}
    </paper-tabs>

    <iron-pages selected="[[post]]" attr-for-selected="name">
        {% for post in site.posts %}
            <{{post.url|remove:'/blog/'|remove:'.html'}} name="{{post.url|remove:'/blog/'|remove:'.html'}}"></{{post.url|remove:'/blog/'|remove:'.html'}}>
        {% endfor %}
    </iron-pages>

  </template>

  <script>

    Polymer({
        is: 'my-blog',

        properties: {

            post: {
                type: String,
                reflectToAttribute: true,
                observer: '_pageChanged'
            },
        },

        observers: [
            '_routePageChanged(routeData.post)'
        ],

        _routePageChanged: function(post) {
            this.post = post || "{{site.posts.first.url|remove:'/blog/'|remove:'.html'}}";
        },

        _pageChanged: function(post) {
            // load page import on demand.
            this.importHref(this.resolveUrl('../blog/' + post + '.html'), null, null, true);
        }

    });

  </script>

</dom-module>
